# VibeGuard å®Œæ•´æ–‡æ¡£

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [é¡¹ç›®è¯„ä»·æŠ¥å‘Š](#é¡¹ç›®è¯„ä»·æŠ¥å‘Š)
3. [æŠ€æœ¯å®ç°è¯¦è§£](#æŠ€æœ¯å®ç°è¯¦è§£)
4. [æ ¸å¿ƒæ¶æ„](#æ ¸å¿ƒæ¶æ„)
5. [è§„åˆ™å¼•æ“ç³»ç»Ÿ](#è§„åˆ™å¼•æ“ç³»ç»Ÿ)
6. [æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ](#æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ)
7. [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)
8. [æµ‹è¯•ç­–ç•¥](#æµ‹è¯•ç­–ç•¥)
9. [éƒ¨ç½²å‘å¸ƒ](#éƒ¨ç½²å‘å¸ƒ)
10. [æ”¹è¿›å»ºè®®ä¸æœªæ¥è§„åˆ’](#æ”¹è¿›å»ºè®®ä¸æœªæ¥è§„åˆ’)

---

## ğŸ” é¡¹ç›®æ¦‚è¿°

VibeGuard æ˜¯ä¸€ä¸ª VS Code æ‰©å±•æ’ä»¶ï¼Œä¸“æ³¨äºå®æ—¶æ£€æµ‹ä»£ç ä¸­çš„è‡´å‘½é”™è¯¯å’Œå®‰å…¨éšæ‚£ï¼Œå¸®åŠ©å¼€å‘è€…ï¼ˆç‰¹åˆ«æ˜¯æ–°æ‰‹ï¼‰é¿å…å¸¸è§ä½†å±é™©çš„ç¼–ç é”™è¯¯ã€‚

### æ ¸å¿ƒç‰¹æ€§
- ğŸ›¡ï¸ **å®æ—¶å®‰å…¨æ£€æµ‹**ï¼šåœ¨ç¼–ç è¿‡ç¨‹ä¸­å³æ—¶å‘ç°æ½œåœ¨é£é™©
- ğŸŒ **ä¸­æ–‡å‹å¥½æç¤º**ï¼šæ¸…æ™°æ˜“æ‡‚çš„ä¸­æ–‡é”™è¯¯æè¿°
- âš¡ **å¢é‡åˆ†æ**ï¼šåªå¤„ç†å˜æ›´éƒ¨åˆ†ï¼Œæ€§èƒ½ä¼˜åŒ–æ˜¾è‘—
- ğŸ”§ **å¿«é€Ÿä¿®å¤**ï¼šæä¾›ä¸€é”®ä¿®å¤å»ºè®®
- ğŸ“¦ **å¤šè¯­è¨€æ”¯æŒ**ï¼šè¦†ç›–ä¸»æµç¼–ç¨‹è¯­è¨€å’Œæ¡†æ¶

### æŠ€æœ¯æ ˆ
- **TypeScript**: å¼ºç±»å‹æ”¯æŒï¼Œæå‡ä»£ç è´¨é‡
- **VS Code Extension API**: åŸç”Ÿé›†æˆï¼ŒåŠŸèƒ½å®Œæ•´
- **å¢é‡åˆ†æå¼•æ“**: æ™ºèƒ½ç¼“å­˜ï¼Œæ€§èƒ½ä¼˜åŒ–50%+
- **LRU ç¼“å­˜**: é˜²æ­¢å†…å­˜æ³„æ¼ï¼Œè‡ªåŠ¨æ¸…ç†æœºåˆ¶

---

## âœ… é¡¹ç›®è¯„ä»·æŠ¥å‘Š

### é¡¹ç›®äº®ç‚¹

#### 1. å·¥ç¨‹åŒ–ç¨‹åº¦é«˜
- TypeScript ä¸¥æ ¼æ¨¡å¼é…ç½®å®Œå–„ (`tsconfig.json` ä¸­å¯ç”¨äº† strict)
- æ¨¡å—åˆ’åˆ†æ¸…æ™°ï¼ŒèŒè´£å•ä¸€ï¼ˆanalyzerã€rulesã€diagnosticsã€cache ç­‰ï¼‰
- ä»£ç é£æ ¼ç»Ÿä¸€ï¼Œæœ‰ ESLint ä¿éšœ
- é¡¹ç›®ç»“æ„åˆç†ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•

#### 2. å®ç°è´¨é‡ä¸é”™
- **å¢é‡åˆ†æå®ç°å·§å¦™**ï¼šæŒ‰è¡Œæ›´æ–°ç¼“å­˜ï¼Œåªå¤„ç†å˜æ›´éƒ¨åˆ†
- **LRU ç¼“å­˜å®ç°å®Œæ•´**ï¼šæœ‰è‡ªåŠ¨æ¸…ç†æœºåˆ¶ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
- **è¯Šæ–­ç®¡ç†å™¨è®¾è®¡è‰¯å¥½**ï¼šä¸ VS Code API é›†æˆç´§å¯†
- **é˜²æŠ–æœºåˆ¶åˆç†**ï¼šé¿å…é¢‘ç¹è§¦å‘åˆ†æ

#### 3. ç”¨æˆ·ä½“éªŒè€ƒè™‘å‘¨å…¨
- ä¸­æ–‡æç¤ºå¯¹å›½å†…å¼€å‘è€…å‹å¥½
- emoji è®©é”™è¯¯ä¿¡æ¯æ›´é†’ç›®ï¼ˆå¦‚ ğŸ’€ è‡´å‘½é”™è¯¯ï¼‰
- æ”¯æŒé…ç½®æ–‡ä»¶è‡ªå®šä¹‰è¡Œä¸º
- æä¾›å¿«é€Ÿä¿®å¤å»ºè®®
- è¿›åº¦æ¡æ˜¾ç¤ºæ‰«æè¿›åº¦

### âš ï¸ æŠ€æœ¯ç“¶é¢ˆåˆ†æ

#### 1. æ­£åˆ™åŒ¹é…çš„æ ¹æœ¬å±€é™

**é—®é¢˜ç¤ºä¾‹**ï¼š
```javascript
// ä»¥ä¸‹æƒ…å†µä¼šå¯¼è‡´è¯¯æŠ¥
// DELETE FROM users; -- è¿™æ˜¯æ³¨é‡Š
const sql = `DELETE FROM users WHERE status = 'deleted'`; // å­—ç¬¦ä¸²ä¸­çš„ DELETE
const example = "UPDATE users SET name = 'John'"; // ç¤ºä¾‹ä»£ç 
```

**æ ¹æœ¬åŸå› **ï¼š
- ç¼ºä¹è¯­æ³•ç†è§£ï¼Œæ— æ³•åŒºåˆ†ä»£ç ä¸Šä¸‹æ–‡
- æ— æ³•è¯†åˆ«æ³¨é‡Šã€å­—ç¬¦ä¸²ã€ç¤ºä¾‹ä»£ç 
- æ­£åˆ™è¡¨è¾¾å¼æ— æ³•ç†è§£ä»£ç è¯­ä¹‰

#### 2. ç¼ºå°‘æµ‹è¯•è¦†ç›–

**ç°çŠ¶**ï¼š
- é¡¹ç›®ä¸­**å®Œå…¨æ²¡æœ‰**å•å…ƒæµ‹è¯•
- åªæœ‰ `test-samples` ç¤ºä¾‹æ–‡ä»¶
- æ— æ³•ä¿è¯è§„åˆ™çš„å‡†ç¡®æ€§
- æ— æ³•éªŒè¯å¢é‡åˆ†æçš„æ­£ç¡®æ€§

**å½±å“**ï¼š
- ä»£ç è´¨é‡æ— æ³•ä¿è¯
- é‡æ„é£é™©é«˜
- æ–°åŠŸèƒ½å¯èƒ½å¼•å…¥ bug

#### 3. æ€§èƒ½ä¼˜åŒ–æ–¹å‘æœ‰è¯¯

**å½“å‰åšæ³•**ï¼š
- ç¼“å­˜äº†åˆ†æç»“æœï¼ˆIssue åˆ—è¡¨ï¼‰
- ä½¿ç”¨ LRU æ·˜æ±°ç­–ç•¥

**é—®é¢˜**ï¼š
- æ­£åˆ™åŒ¹é…æœ¬èº«å°±å¾ˆå¿«ï¼Œç¼“å­˜æ”¶ç›Šæœ‰é™
- çœŸæ­£çš„ç“¶é¢ˆæ˜¯å¤§æ–‡ä»¶çš„é€è¡Œæ‰«æ
- åº”è¯¥ç¼“å­˜æ–‡ä»¶çš„ ASTï¼Œè€Œä¸æ˜¯ Issue åˆ—è¡¨

#### 4. è§„åˆ™ç³»ç»Ÿä¸å¤Ÿçµæ´»

**å±€é™æ€§**ï¼š
- è§„åˆ™ç¡¬ç¼–ç åœ¨ definitions æ–‡ä»¶ä¸­
- æ— æ³•åŠ¨æ€åŠ è½½ç”¨æˆ·è‡ªå®šä¹‰è§„åˆ™
- æ— æ³•æ ¹æ®é¡¹ç›®ç±»å‹è°ƒæ•´è§„åˆ™ä¸¥æ ¼åº¦
- ä¸æ”¯æŒè§„åˆ™çš„å¯ç”¨/ç¦ç”¨

### ğŸ“Š é¡¹ç›®è¯„åˆ†

- **ä»£ç è´¨é‡**ï¼šâ­â­â­â­â˜† (4/5)
- **æ¶æ„è®¾è®¡**ï¼šâ­â­â­â­â˜† (4/5)
- **ç”¨æˆ·ä½“éªŒ**ï¼šâ­â­â­â­â­ (5/5)
- **æŠ€æœ¯æ·±åº¦**ï¼šâ­â­â­â˜†â˜† (3/5)
- **æ‰©å±•æ€§**ï¼šâ­â­â­â˜†â˜† (3/5)

**æ€»ä½“è¯„ä»·**ï¼šâ­â­â­â­â˜† (4/5)

---

## ğŸ”§ æŠ€æœ¯å®ç°è¯¦è§£

### æ ¸å¿ƒæ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                VS Code Editor                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           VibeGuard Extension Layer              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Analyzer â”‚  Rules    â”‚Diagnosticsâ”‚   Utils      â”‚
â”‚  Engine  â”‚  Engine   â”‚  Manager  â”‚              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Cache & Performance                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¡¹ç›®ç›®å½•ç»“æ„

```
VibeGuard/
â”œâ”€â”€ package.json                 # æ’ä»¶é…ç½®å’Œä¾èµ–
â”œâ”€â”€ tsconfig.json               # TypeScript é…ç½®
â”œâ”€â”€ .eslintrc.json              # ä»£ç è§„èŒƒ
â”œâ”€â”€ .vscodeignore               # æ‰“åŒ…å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ extension.ts            # æ’ä»¶ä¸»å…¥å£
â”‚   â”œâ”€â”€ analyzer/
â”‚   â”‚   â”œâ”€â”€ CodeAnalyzer.ts     # ä»£ç åˆ†æå™¨æ ¸å¿ƒ
â”‚   â”‚   â”œâ”€â”€ IncrementalAnalyzer.ts # å¢é‡åˆ†æ
â”‚   â”‚   â””â”€â”€ FileScanner.ts      # æ–‡ä»¶æ‰«æå™¨
â”‚   â”œâ”€â”€ rules/
â”‚   â”‚   â”œâ”€â”€ RuleEngine.ts       # è§„åˆ™å¼•æ“
â”‚   â”‚   â”œâ”€â”€ RuleLoader.ts       # è§„åˆ™åŠ è½½å™¨
â”‚   â”‚   â”œâ”€â”€ definitions/        # è§„åˆ™å®šä¹‰æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ sql-rules.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ javascript-rules.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ typescript-rules.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ react-rules.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ vue-rules.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ nodejs-rules.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ python-rules.ts
â”‚   â”‚   â”‚   â””â”€â”€ config-rules.ts
â”‚   â”‚   â””â”€â”€ matchers/           # è§„åˆ™åŒ¹é…å™¨
â”‚   â”‚       â”œâ”€â”€ RegexMatcher.ts
â”‚   â”‚       â””â”€â”€ ASTMatcher.ts
â”‚   â”œâ”€â”€ diagnostics/
â”‚   â”‚   â”œâ”€â”€ DiagnosticManager.ts # è¯Šæ–­ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ QuickFixProvider.ts  # å¿«é€Ÿä¿®å¤
â”‚   â”‚   â””â”€â”€ MessageFormatter.ts  # æ¶ˆæ¯æ ¼å¼åŒ–
â”‚   â”œâ”€â”€ parsers/
â”‚   â”‚   â”œâ”€â”€ JavaScriptParser.ts  # JS/TS è§£æ
â”‚   â”‚   â”œâ”€â”€ PythonParser.ts      # Python è§£æ
â”‚   â”‚   â””â”€â”€ SQLParser.ts         # SQL è§£æ
â”‚   â”œâ”€â”€ cache/
â”‚   â”‚   â”œâ”€â”€ CacheManager.ts      # ç¼“å­˜ç®¡ç†
â”‚   â”‚   â””â”€â”€ FileCache.ts         # æ–‡ä»¶ç¼“å­˜
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”œâ”€â”€ Settings.ts          # é…ç½®ç®¡ç†
â”‚   â”‚   â””â”€â”€ defaults.ts          # é»˜è®¤é…ç½®
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ logger.ts            # æ—¥å¿—å·¥å…·
â”‚       â”œâ”€â”€ debounce.ts          # é˜²æŠ–å‡½æ•°
â”‚       â””â”€â”€ performance.ts       # æ€§èƒ½ç›‘æ§
â”œâ”€â”€ test/
â”‚   â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ fixtures/                # æµ‹è¯•æ•°æ®
â””â”€â”€ resources/
    â”œâ”€â”€ icons/                   # å›¾æ ‡èµ„æº
    â””â”€â”€ templates/               # æ¨¡æ¿æ–‡ä»¶
```

---

## ğŸš€ æ ¸å¿ƒæ¶æ„

### 1. æ’ä»¶å…¥å£ (extension.ts)

```typescript
import * as vscode from 'vscode';
import { CodeAnalyzer } from './analyzer/CodeAnalyzer';
import { DiagnosticManager } from './diagnostics/DiagnosticManager';
import { RuleEngine } from './rules/RuleEngine';
import { CacheManager } from './cache/CacheManager';
import { Settings } from './config/Settings';

export function activate(context: vscode.ExtensionContext) {
    // åˆå§‹åŒ–æ ¸å¿ƒç»„ä»¶
    const settings = new Settings();
    const cache = new CacheManager();
    const ruleEngine = new RuleEngine(settings);
    const analyzer = new CodeAnalyzer(ruleEngine, cache);
    const diagnosticManager = new DiagnosticManager();

    // æ³¨å†Œæ–‡æ¡£å˜æ›´ç›‘å¬
    const documentChangeListener = vscode.workspace.onDidChangeTextDocument(
        debounce(async (event) => {
            if (shouldAnalyze(event.document)) {
                const issues = await analyzer.analyzeIncremental(event);
                diagnosticManager.updateDiagnostics(event.document, issues);
            }
        }, 500)
    );

    // æ³¨å†Œæ–‡ä»¶ä¿å­˜ç›‘å¬
    const saveListener = vscode.workspace.onDidSaveTextDocument(
        async (document) => {
            const issues = await analyzer.analyzeFull(document);
            diagnosticManager.updateDiagnostics(document, issues);
        }
    );

    // æ³¨å†Œå¿«é€Ÿä¿®å¤æä¾›è€…
    const quickFixProvider = vscode.languages.registerCodeActionProvider(
        { pattern: '**/*' },
        new QuickFixProvider(diagnosticManager),
        { providedCodeActionKinds: [vscode.CodeActionKind.QuickFix] }
    );

    // æ³¨å†Œå‘½ä»¤
    const scanCommand = vscode.commands.registerCommand(
        'vibeguard.scanWorkspace',
        async () => {
            await scanWorkspace(analyzer, diagnosticManager);
        }
    );

    // æ·»åŠ åˆ°è®¢é˜…åˆ—è¡¨
    context.subscriptions.push(
        documentChangeListener,
        saveListener,
        quickFixProvider,
        scanCommand,
        diagnosticManager
    );

    // åˆå§‹æ‰«æ
    scanOpenDocuments(analyzer, diagnosticManager);
}

export function deactivate() {
    // æ¸…ç†èµ„æº
}
```

### 2. ä»£ç åˆ†æå™¨ (CodeAnalyzer.ts)

```typescript
import { TextDocument, TextDocumentChangeEvent } from 'vscode';
import { RuleEngine } from '../rules/RuleEngine';
import { CacheManager } from '../cache/CacheManager';
import { Issue, Severity } from '../types';

export class CodeAnalyzer {
    constructor(
        private ruleEngine: RuleEngine,
        private cache: CacheManager
    ) {}

    async analyzeIncremental(event: TextDocumentChangeEvent): Promise<Issue[]> {
        const document = event.document;
        const cacheKey = document.uri.toString();
        
        // è·å–ç¼“å­˜çš„åˆ†æç»“æœ
        let cachedIssues = this.cache.get(cacheKey) || [];
        
        // å¤„ç†æ¯ä¸ªå˜æ›´
        for (const change of event.contentChanges) {
            const startLine = change.range.start.line;
            const endLine = change.range.end.line;
            
            // ç§»é™¤å—å½±å“è¡Œçš„æ—§é—®é¢˜
            cachedIssues = cachedIssues.filter(
                issue => issue.line < startLine || issue.line > endLine
            );
            
            // åˆ†æå˜æ›´çš„æ–‡æœ¬
            const newIssues = await this.analyzeText(
                change.text,
                document.languageId,
                startLine
            );
            
            // åˆå¹¶æ–°é—®é¢˜
            cachedIssues.push(...newIssues);
        }
        
        // æ›´æ–°ç¼“å­˜
        this.cache.set(cacheKey, cachedIssues);
        
        return cachedIssues;
    }

    async analyzeFull(document: TextDocument): Promise<Issue[]> {
        const text = document.getText();
        const languageId = document.languageId;
        
        // æ‰§è¡Œå®Œæ•´åˆ†æ
        const issues = await this.analyzeText(text, languageId, 0);
        
        // æ›´æ–°ç¼“å­˜
        this.cache.set(document.uri.toString(), issues);
        
        return issues;
    }

    private async analyzeText(
        text: string,
        languageId: string,
        lineOffset: number
    ): Promise<Issue[]> {
        const issues: Issue[] = [];
        
        // åº”ç”¨å¯¹åº”è¯­è¨€çš„è§„åˆ™
        const rules = this.ruleEngine.getRulesForLanguage(languageId);
        
        for (const rule of rules) {
            const matches = await rule.check(text);
            
            for (const match of matches) {
                issues.push({
                    line: match.line + lineOffset,
                    column: match.column,
                    severity: rule.severity,
                    message: rule.message,
                    code: rule.code,
                    quickFix: rule.quickFix
                });
            }
        }
        
        return issues;
    }
}
```

---

## ğŸ“ è§„åˆ™å¼•æ“ç³»ç»Ÿ

### æ”¯æŒçš„è¯­è¨€å’Œæ¡†æ¶
- **å‰ç«¯**: JavaScript, TypeScript, React, Vue
- **åç«¯**: Node.js, Python
- **æ•°æ®åº“**: SQL (MySQL, PostgreSQL, SQLite)
- **é…ç½®æ–‡ä»¶**: JSON, YAML, .env, Dockerfile, package.json

### è§„åˆ™å®šä¹‰æ ¼å¼

```typescript
interface Rule {
    code: string;           // è§„åˆ™ç¼–ç 
    severity: 'error' | 'warning' | 'info';
    message: string;        // ç”¨æˆ·å‹å¥½çš„æç¤ºä¿¡æ¯
    pattern?: RegExp;       // æ­£åˆ™åŒ¹é…æ¨¡å¼
    astPattern?: ASTPattern; // AST åŒ¹é…æ¨¡å¼
    quickFix?: QuickFix;    // å¿«é€Ÿä¿®å¤æ–¹æ¡ˆ
    metadata?: {
        category: string;   // åˆ†ç±»ï¼šsecurity, performance, quality
        tags: string[];     // æ ‡ç­¾
        docs: string;       // æ–‡æ¡£é“¾æ¥
    };
}
```

### æ ¸å¿ƒæ£€æµ‹åœºæ™¯

#### 1. æ•°æ®åº“æ“ä½œå®‰å…¨
- **æ— æ¡ä»¶åˆ é™¤/æ›´æ–°**: DELETE/UPDATE ç¼ºå°‘ WHERE æ¡ä»¶
- **DROP DATABASE/TABLE**: æ£€æµ‹å±é™©çš„åˆ è¡¨æ“ä½œ
- **SQL æ³¨å…¥**: å­—ç¬¦ä¸²æ‹¼æ¥æ„é€  SQL
- **TRUNCATE**: æ¸…ç©ºè¡¨æ“ä½œ

#### 2. ä»£ç æ‰§è¡Œé£é™©
- **eval/exec**: JavaScript/Python ä¸­æ‰§è¡Œä»»æ„ä»£ç 
- **child_process**: Node.js å‘½ä»¤æ³¨å…¥
- **dangerouslySetInnerHTML**: React XSS é£é™©
- **v-html**: Vue XSS é£é™©

#### 3. æ•æ„Ÿä¿¡æ¯æ³„éœ²
- **API Keys**: AWS, Azure, Google Cloud å¯†é’¥
- **æ•°æ®åº“å¯†ç **: æ˜æ–‡å­˜å‚¨çš„è¿æ¥å­—ç¬¦ä¸²
- **Token/Secret**: JWT, OAuth ç­‰è®¤è¯ä¿¡æ¯
- **ç”Ÿäº§ç¯å¢ƒé…ç½®**: debug=true, CORS *

#### 4. æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- **rm -rf /**: å±é™©çš„åˆ é™¤å‘½ä»¤
- **fs.unlink/rmdir**: æ— æ£€æŸ¥çš„æ–‡ä»¶åˆ é™¤
- **os.remove**: Python æ–‡ä»¶åˆ é™¤
- **è·¯å¾„éå†**: ../../../etc/passwd

#### 5. å¼‚æ­¥ç¼–ç¨‹é™·é˜±
- **forEach + async/await**: ä¸ä¼šç­‰å¾…æ‰§è¡Œ
- **æœªå¤„ç†çš„ Promise rejection**: å¯¼è‡´è¿›ç¨‹å´©æºƒ
- **useEffect ä¾èµ–ç¼ºå¤±**: React æ— é™å¾ªç¯
- **å†…å­˜æ³„æ¼**: æœªæ¸…ç†çš„äº‹ä»¶ç›‘å¬å™¨

### è§„åˆ™å¼•æ“å®ç°

```typescript
export class RuleEngine {
    private rules: Map<string, Rule[]> = new Map();
    private regexMatcher: RegexMatcher;
    private astMatcher: ASTMatcher;

    constructor(settings: Settings) {
        this.regexMatcher = new RegexMatcher();
        this.astMatcher = new ASTMatcher();
        this.loadRules(settings);
    }

    private loadRules(settings: Settings) {
        // åŠ è½½ SQL è§„åˆ™
        this.rules.set('sql', [
            {
                code: 'SQL001',
                severity: 'error',
                message: 'ğŸ’€ è‡´å‘½é”™è¯¯ï¼šDELETE æ²¡æœ‰ WHERE æ¡ä»¶ä¼šåˆ é™¤æ•´ä¸ªè¡¨ï¼è¿™ç›¸å½“äºæŠŠæ•´ä¸ªæ•°æ®åº“æ‰”è¿›åƒåœ¾æ¡¶ï¼',
                pattern: /DELETE\s+FROM\s+\w+\s*(?!WHERE)/gi,
                quickFix: {
                    title: 'æ·»åŠ  WHERE æ¡ä»¶',
                    replacement: 'DELETE FROM $1 WHERE id = ?'
                }
            },
            // ... æ›´å¤šè§„åˆ™
        ]);

        // åŠ è½½å…¶ä»–è¯­è¨€è§„åˆ™...
    }

    getRulesForLanguage(languageId: string): Rule[] {
        // æ™ºèƒ½åŒ¹é…è¯­è¨€å¯¹åº”çš„è§„åˆ™é›†
        const languageMappings: Record<string, string[]> = {
            'javascript': ['javascript'],
            'typescript': ['javascript', 'typescript'],
            'javascriptreact': ['javascript', 'react'],
            'typescriptreact': ['javascript', 'typescript', 'react'],
            'vue': ['javascript', 'vue'],
            'python': ['python'],
            'sql': ['sql'],
            // ... æ›´å¤šæ˜ å°„
        };

        const ruleSets = languageMappings[languageId] || ['javascript'];
        const rules: Rule[] = [];
        
        for (const ruleSet of ruleSets) {
            const ruleList = this.rules.get(ruleSet);
            if (ruleList) {
                rules.push(...ruleList);
            }
        }
        
        return rules;
    }
}
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–æ–¹æ¡ˆ

### 1. å¢é‡åˆ†æä¼˜åŒ–

```typescript
class IncrementalAnalyzer {
    private changeBuffer: ChangeEvent[] = [];
    private processTimer: NodeJS.Timeout | null = null;

    handleChange(event: TextDocumentChangeEvent) {
        this.changeBuffer.push(event);
        
        if (this.processTimer) {
            clearTimeout(this.processTimer);
        }
        
        this.processTimer = setTimeout(() => {
            this.processBatch();
        }, 500); // 500ms é˜²æŠ–
    }

    private processBatch() {
        // åˆå¹¶ç›¸é‚»çš„å˜æ›´
        const mergedChanges = this.mergeChanges(this.changeBuffer);
        
        // æ‰¹é‡å¤„ç†
        for (const change of mergedChanges) {
            this.analyzeChange(change);
        }
        
        this.changeBuffer = [];
    }
}
```

### 2. ç¼“å­˜ç­–ç•¥

```typescript
class CacheManager {
    private cache = new Map<string, CacheEntry>();
    private maxSize = 100; // æœ€å¤§ç¼“å­˜æ–‡ä»¶æ•°
    private ttl = 60000; // 60ç§’è¿‡æœŸ

    set(key: string, value: any) {
        // LRU æ·˜æ±°ç­–ç•¥
        if (this.cache.size >= this.maxSize) {
            const firstKey = this.cache.keys().next().value;
            this.cache.delete(firstKey);
        }

        this.cache.set(key, {
            value,
            timestamp: Date.now()
        });
    }

    get(key: string): any | null {
        const entry = this.cache.get(key);
        
        if (!entry) return null;
        
        // æ£€æŸ¥è¿‡æœŸ
        if (Date.now() - entry.timestamp > this.ttl) {
            this.cache.delete(key);
            return null;
        }
        
        return entry.value;
    }
}
```

### 3. Web Worker å¹¶è¡Œå¤„ç†

```typescript
// worker.ts
self.addEventListener('message', async (event) => {
    const { text, rules } = event.data;
    const results = await analyzeWithRules(text, rules);
    self.postMessage(results);
});

// ä¸»çº¿ç¨‹
class ParallelAnalyzer {
    private worker: Worker;

    constructor() {
        this.worker = new Worker('worker.js');
    }

    async analyze(text: string, rules: Rule[]): Promise<Issue[]> {
        return new Promise((resolve) => {
            this.worker.postMessage({ text, rules });
            this.worker.onmessage = (event) => {
                resolve(event.data);
            };
        });
    }
}
```

### æ€§èƒ½æŒ‡æ ‡

**ç›®æ ‡æŒ‡æ ‡**ï¼š
- **å¯åŠ¨æ—¶é—´**: < 500ms
- **å¢é‡åˆ†æå»¶è¿Ÿ**: < 100ms
- **å…¨æ–‡ä»¶åˆ†æ**: < 1s (5000è¡Œä»¥å†…)
- **å†…å­˜å ç”¨**: < 50MB
- **CPU å ç”¨**: < 5%

---

## ğŸ‘¨â€ğŸ’» å¼€å‘æŒ‡å—

### ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£… Node.js 18+
node --version

# å®‰è£…å¼€å‘å·¥å…·
npm install -g yo generator-code vsce

# åˆ›å»ºé¡¹ç›®
yo code
# é€‰æ‹©: New Extension (TypeScript)
# åç§°: vibeguard
```

### ä¾èµ–å®‰è£…

```json
{
  "devDependencies": {
    "@types/vscode": "^1.84.0",
    "@types/node": "20.x",
    "@typescript-eslint/eslint-plugin": "^6.0.0",
    "@typescript-eslint/parser": "^6.0.0",
    "eslint": "^8.0.0",
    "typescript": "^5.0.0",
    "webpack": "^5.0.0",
    "webpack-cli": "^5.0.0",
    "@vscode/test-electron": "^2.3.0"
  },
  "dependencies": {
    "esprima": "^4.0.1",
    "@babel/parser": "^7.0.0",
    "sql-parser": "^1.0.0"
  }
}
```

### å¼€å‘å‘½ä»¤

```bash
# ç¼–è¯‘
npm run compile

# ç›‘å¬æ¨¡å¼
npm run watch

# æµ‹è¯•
npm test

# æ‰“åŒ…
vsce package

# è°ƒè¯•
# æŒ‰ F5 å¯åŠ¨æ‰©å±•å¼€å‘ä¸»æœº
```

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### 1. å•å…ƒæµ‹è¯•ç¤ºä¾‹

```typescript
// test/unit/RuleEngine.test.ts
import { RuleEngine } from '../../src/rules/RuleEngine';

describe('RuleEngine', () => {
    let engine: RuleEngine;

    beforeEach(() => {
        engine = new RuleEngine();
    });

    test('æ£€æµ‹ SQL æ— æ¡ä»¶åˆ é™¤', async () => {
        const sql = 'DELETE FROM users';
        const rules = engine.getRulesForLanguage('sql');
        const issues = await engine.checkText(sql, rules);
        
        expect(issues).toHaveLength(1);
        expect(issues[0].code).toBe('SQL001');
    });

    test('æ£€æµ‹ JavaScript eval ä½¿ç”¨', async () => {
        const js = 'const result = eval(userInput);';
        const rules = engine.getRulesForLanguage('javascript');
        const issues = await engine.checkText(js, rules);
        
        expect(issues).toHaveLength(1);
        expect(issues[0].code).toBe('JS001');
    });

    test('æ£€æµ‹ API Key ç¡¬ç¼–ç ', async () => {
        const code = 'const api_key = "sk-1234567890";';
        const rules = engine.getRulesForLanguage('javascript');
        const issues = await engine.checkText(code, rules);
        
        expect(issues).toHaveLength(1);
        expect(issues[0].code).toBe('JS003');
    });
});
```

### 2. é›†æˆæµ‹è¯•

```typescript
// test/integration/extension.test.ts
import * as vscode from 'vscode';
import * as path from 'path';

suite('Extension Integration Tests', () => {
    test('æ£€æµ‹å±é™©ä»£ç å¹¶æä¾›è¯Šæ–­', async () => {
        const doc = await vscode.workspace.openTextDocument({
            language: 'javascript',
            content: 'eval("alert(1)")'
        });

        await vscode.window.showTextDocument(doc);
        
        // ç­‰å¾…åˆ†æå®Œæˆ
        await new Promise(resolve => setTimeout(resolve, 1000));

        const diagnostics = vscode.languages.getDiagnostics(doc.uri);
        
        assert.strictEqual(diagnostics.length, 1);
        assert.strictEqual(diagnostics[0].message.includes('eval'), true);
    });
});
```

### 3. æ€§èƒ½æµ‹è¯•

```typescript
// test/performance/analyzer.perf.ts
describe('Performance Tests', () => {
    test('å¤§æ–‡ä»¶åˆ†ææ€§èƒ½', async () => {
        const largeFile = generateLargeFile(10000); // 10000è¡Œä»£ç 
        
        const startTime = Date.now();
        await analyzer.analyzeFull(largeFile);
        const duration = Date.now() - startTime;
        
        expect(duration).toBeLessThan(1000); // åº”åœ¨1ç§’å†…å®Œæˆ
    });

    test('å¢é‡åˆ†ææ€§èƒ½', async () => {
        const changes = generateChanges(100); // 100ä¸ªå˜æ›´
        
        const startTime = Date.now();
        for (const change of changes) {
            await analyzer.analyzeIncremental(change);
        }
        const duration = Date.now() - startTime;
        
        expect(duration).toBeLessThan(500); // åº”åœ¨500mså†…å®Œæˆ
    });
});
```

---

## ğŸ“¦ éƒ¨ç½²å‘å¸ƒ

### 1. æ„å»ºé…ç½®

```javascript
// webpack.config.js
const path = require('path');

module.exports = {
    target: 'node',
    mode: 'production',
    entry: './src/extension.ts',
    output: {
        path: path.resolve(__dirname, 'dist'),
        filename: 'extension.js',
        libraryTarget: 'commonjs2'
    },
    externals: {
        vscode: 'commonjs vscode'
    },
    resolve: {
        extensions: ['.ts', '.js']
    },
    module: {
        rules: [{
            test: /\.ts$/,
            exclude: /node_modules/,
            use: 'ts-loader'
        }]
    },
    optimization: {
        minimize: true
    }
};
```

### 2. å‘å¸ƒæµç¨‹

```bash
# 1. æ›´æ–°ç‰ˆæœ¬å·
npm version patch/minor/major

# 2. æ„å»º
npm run compile

# 3. æ‰“åŒ…
vsce package

# 4. æœ¬åœ°æµ‹è¯•
code --install-extension vibeguard-0.1.0.vsix

# 5. å‘å¸ƒåˆ° Marketplace
vsce publish

# 6. å‘å¸ƒåˆ° GitHub
git tag v0.1.0
git push origin v0.1.0
```

### 3. CI/CD é…ç½®

```yaml
# .github/workflows/release.yml
name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18
          
      - name: Install dependencies
        run: npm ci
        
      - name: Run tests
        run: npm test
        
      - name: Build
        run: npm run compile
        
      - name: Package
        run: npx vsce package
        
      - name: Publish to Marketplace
        run: npx vsce publish -p ${{ secrets.VSCE_TOKEN }}
        
      - name: Create GitHub Release
        uses: softprops/action-gh-release@v1
        with:
          files: '*.vsix'
```

---

## ğŸ’¡ æ”¹è¿›å»ºè®®ä¸æœªæ¥è§„åˆ’

### çŸ­æœŸæ”¹è¿›ï¼ˆ1-2ä¸ªæœˆï¼‰

#### 1. å¼•å…¥çœŸæ­£çš„è¯­æ³•åˆ†æ

```typescript
// ä½¿ç”¨ TypeScript Compiler API
import * as ts from 'typescript';

class ASTAnalyzer {
    analyzeTypeScript(code: string) {
        const sourceFile = ts.createSourceFile(
            'temp.ts', 
            code, 
            ts.ScriptTarget.Latest,
            true
        );
        
        // éå† AST æ‰¾å±é™©æ¨¡å¼
        ts.forEachChild(sourceFile, node => {
            if (ts.isCallExpression(node)) {
                // æ£€æŸ¥å±é™©å‡½æ•°è°ƒç”¨
                this.checkDangerousCall(node);
            }
        });
    }
}
```

#### 2. æ™ºèƒ½ä¸Šä¸‹æ–‡æ„ŸçŸ¥

```typescript
interface AnalysisContext {
    isInComment: boolean;
    isInString: boolean;
    isTestFile: boolean;
    isExampleCode: boolean;
    frameworkContext?: 'react' | 'vue' | 'node';
    scopeVariables: Map<string, VariableInfo>;
}

// æ ¹æ®ä¸Šä¸‹æ–‡è°ƒæ•´æ£€æµ‹ç­–ç•¥
class ContextAwareAnalyzer {
    analyze(code: string, context: AnalysisContext) {
        if (context.isTestFile) {
            // æµ‹è¯•æ–‡ä»¶ä¸­å…è®¸æŸäº›"å±é™©"æ“ä½œ
            this.relaxRules(['SQL001', 'NODE002']);
        }
    }
}
```

#### 3. å»ºç«‹è§„åˆ™ç”Ÿæ€ç³»ç»Ÿ

```typescript
// .vibeguard/rules/custom-rule.js
export default {
    code: 'CUSTOM001',
    severity: 'error',
    message: 'è‡ªå®šä¹‰è§„åˆ™ï¼šç¦æ­¢ä½¿ç”¨ç‰¹å®š API',
    test: (node, context) => {
        // è‡ªå®šä¹‰æ£€æµ‹é€»è¾‘
        if (node.type === 'CallExpression' && 
            node.callee.name === 'dangerousAPI') {
            return true;
        }
        return false;
    }
}

// æ”¯æŒä» npm å®‰è£…è§„åˆ™åŒ…
// npm install @vibeguard/rules-finance
// npm install @vibeguard/rules-healthcare
```

### ä¸­æœŸç›®æ ‡ï¼ˆ3-6ä¸ªæœˆï¼‰

1. **å»ºç«‹è§„åˆ™å¸‚åœº**ï¼šå…è®¸ç¤¾åŒºè´¡çŒ®å’Œåˆ†äº«è§„åˆ™
2. **æ”¯æŒé¡¹ç›®é…ç½®**ï¼š`.vibeguardrc` é…ç½®æ–‡ä»¶
3. **é›†æˆ CI/CD**ï¼šæä¾›å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒ Git hooks

### é•¿æœŸæ„¿æ™¯ï¼ˆ6-12ä¸ªæœˆï¼‰

1. **AI å¢å¼º**ï¼šä½¿ç”¨æœºå™¨å­¦ä¹ è¯†åˆ«å±é™©æ¨¡å¼
2. **å®‰å…¨æŠ¥å‘Š**ï¼šç”Ÿæˆé¡¹ç›®å®‰å…¨è¯„åˆ†å’Œæ”¹è¿›å»ºè®®
3. **è·¨ IDE æ”¯æŒ**ï¼šä¸ä»…é™äº VS Code

### ğŸ¯ æ ¸å¿ƒæ´å¯Ÿ

**ä½ åœ¨åšä¸€ä¸ª"é€šç”¨"çš„å®‰å…¨æ£€æµ‹å·¥å…·ï¼Œä½†å®‰å…¨é—®é¢˜å¾€å¾€æ˜¯"ç‰¹å®š"çš„ã€‚**

å»ºè®®ï¼š
1. **ä¸“æ³¨ç»†åˆ†åœºæ™¯**ï¼šæ·±è€• JavaScript/TypeScript ç”Ÿæ€
2. **ä»"æ£€æµ‹"åˆ°"é¢„é˜²"**ï¼šæä¾›å®‰å…¨çš„ä»£ç æ¨¡æ¿
3. **ç¤¾åŒºé©±åŠ¨**ï¼šè®©ç”¨æˆ·è´¡çŒ®çœŸå®åœºæ™¯çš„è§„åˆ™

### é£é™©å’Œè§£å†³æ–¹æ¡ˆ

#### æŠ€æœ¯é£é™©
1. **AST è§£ææ€§èƒ½é—®é¢˜**
   - é£é™©ï¼šå¤§æ–‡ä»¶è§£ææ…¢
   - è§£å†³ï¼šä½¿ç”¨ Web Workerï¼Œé™åˆ¶è§£æèŒƒå›´

2. **è¯¯æŠ¥ç‡é«˜**
   - é£é™©ï¼šè§„åˆ™è¿‡äºä¸¥æ ¼
   - è§£å†³ï¼šæä¾›é…ç½®é€‰é¡¹ï¼Œæ”¯æŒè§„åˆ™çº§åˆ«è°ƒæ•´

3. **å†…å­˜æ³„æ¼**
   - é£é™©ï¼šç¼“å­˜æ— é™å¢é•¿
   - è§£å†³ï¼šLRU ç¼“å­˜ï¼Œå®šæœŸæ¸…ç†

#### ç”¨æˆ·ä½“éªŒé£é™©
1. **è¿‡å¤šæç¤ºå¹²æ‰°**
   - è§£å†³ï¼šæ™ºèƒ½é˜²æŠ–ï¼Œæ‰¹é‡æ˜¾ç¤º

2. **æ–°æ‰‹ä¸ç†è§£æç¤º**
   - è§£å†³ï¼šæä¾›è¯¦ç»†æ–‡æ¡£é“¾æ¥ï¼Œè§†é¢‘æ•™ç¨‹

---

## ğŸ æ€»ç»“

VibeGuard æ˜¯ä¸€ä¸ª**æœ‰æ½œåŠ›çš„é¡¹ç›®**ï¼ŒæŠ€æœ¯å®ç°æ‰å®ï¼Œç”¨æˆ·ä½“éªŒå‡ºè‰²ã€‚ä¸»è¦éœ€è¦çªç ´"æ­£åˆ™åŒ¹é…"çš„æ€ç»´æ¡†æ¶ï¼Œå¼•å…¥æ›´æ™ºèƒ½çš„ä»£ç åˆ†ææ–¹æ³•ã€‚è¿™ä¸ªé¡¹ç›®çš„ä»·å€¼åœ¨äº**è®©æ›´å¤šäººæ„è¯†åˆ°ä»£ç å®‰å…¨çš„é‡è¦æ€§**ã€‚

æœ¬æ–‡æ¡£æä¾›äº† VibeGuard æ’ä»¶çš„å®Œæ•´å®ç°æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š
- âœ… è¯¦ç»†çš„æ¶æ„è®¾è®¡å’Œæ¨¡å—åˆ’åˆ†
- âœ… æ ¸å¿ƒåŠŸèƒ½çš„ä»£ç å®ç°
- âœ… æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
- âœ… å®Œæ•´çš„æµ‹è¯•æ–¹æ¡ˆ
- âœ… éƒ¨ç½²å’Œå‘å¸ƒæµç¨‹
- âœ… æ”¹è¿›å»ºè®®å’Œæœªæ¥è§„åˆ’

é€šè¿‡è¿™ä»½æ–‡æ¡£ï¼Œå¼€å‘å›¢é˜Ÿå¯ä»¥å¿«é€Ÿç†è§£é¡¹ç›®æ¶æ„ï¼Œå¹¶æŒ‰ç…§æ—¢å®šæ–¹æ¡ˆå®ç°ä¸€ä¸ªé«˜è´¨é‡çš„ VS Code å®‰å…¨æ’ä»¶ã€‚

ç»§ç»­åŠ æ²¹ï¼ğŸ’ª

---

*æœ¬æ–‡æ¡£åŸºäº 2025-09-12 çš„ä»£ç å®¡æŸ¥ï¼Œæ—¨åœ¨æä¾›å»ºè®¾æ€§çš„æ”¹è¿›å»ºè®®ã€‚*